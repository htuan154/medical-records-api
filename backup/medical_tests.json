{
  "total_rows": 2,
  "offset": 0,
  "rows": [
    {
      "id": "_design/_design/medical_tests",
      "key": "_design/_design/medical_tests",
      "value": {
        "rev": "4-65d45ae6e0101ba4d4fccae68ef89c46"
      },
      "doc": {
        "_id": "_design/_design/medical_tests",
        "_rev": "4-65d45ae6e0101ba4d4fccae68ef89c46",
        "views": {
          "by_patient": {
            "map": "function (doc) {\r\n  if (doc.type === 'medical_test') {\r\n    emit(doc.patient_id, {\r\n      id: doc._id,\r\n      test_name: doc.test_info.test_name,\r\n      test_type: doc.test_info.test_type,\r\n      result_date: doc.test_info.result_date,\r\n      status: doc.status\r\n    });\r\n  }\r\n}\r\n"
          },
          "by_test_type": {
            "map": "function (doc) {\r\n  if (doc.type === 'medical_test') {\r\n    emit(doc.test_info.test_type, {\r\n      id: doc._id,\r\n      patient_id: doc.patient_id,\r\n      test_name: doc.test_info.test_name,\r\n      result_date: doc.test_info.result_date,\r\n      status: doc.status\r\n    });\r\n  }\r\n}\r\n"
          },
          "by_date": {
            "map": "function (doc) {\r\n  if (doc.type === 'medical_test' && doc.test_info.result_date) {\r\n    var date = doc.test_info.result_date.split('T')[0];\r\n    emit(date, {\r\n      id: doc._id,\r\n      patient_id: doc.patient_id,\r\n      test_name: doc.test_info.test_name,\r\n      status: doc.status\r\n    });\r\n  }\r\n}\r\n"
          },
          "abnormal_results": {
            "map": "function (doc) {\r\n  if (doc.type === 'medical_test' && doc.results) {\r\n    var hasAbnormal = false;\r\n    for (var key in doc.results) {\r\n      if (doc.results[key].status && doc.results[key].status !== 'normal') {\r\n        hasAbnormal = true;\r\n        break;\r\n      }\r\n    }\r\n    if (hasAbnormal) {\r\n      emit(doc.patient_id, {\r\n        id: doc._id,\r\n        test_name: doc.test_info.test_name,\r\n        result_date: doc.test_info.result_date,\r\n        interpretation: doc.interpretation\r\n      });\r\n    }\r\n  }\r\n}\r\n"
          }
        },
        "language": "javascript"
      }
    },
    {
      "id": "test_2024_001",
      "key": "test_2024_001",
      "value": {
        "rev": "1-2ff3f35a7631d6890c5ffa6a6781d9a1"
      },
      "doc": {
        "_id": "test_2024_001",
        "_rev": "1-2ff3f35a7631d6890c5ffa6a6781d9a1",
        "type": "medical_test",
        "patient_id": "patient_2024_001",
        "doctor_id": "doctor_2024_001",
        "medical_record_id": "record_2024_001",
        "test_info": {
          "test_type": "blood_work",
          "test_name": "Tổng phân tích máu",
          "ordered_date": "2024-01-20T10:45:00Z",
          "sample_collected_date": "2024-01-21T08:00:00Z",
          "result_date": "2024-01-21T16:00:00Z"
        },
        "results": {
          "wbc": {
            "value": 7.2,
            "unit": "10^9/L",
            "reference_range": "4.0-10.0",
            "status": "normal"
          },
          "rbc": {
            "value": 4.5,
            "unit": "10^12/L",
            "reference_range": "4.2-5.4",
            "status": "normal"
          },
          "hemoglobin": {
            "value": 14.2,
            "unit": "g/dL",
            "reference_range": "12.0-16.0",
            "status": "normal"
          },
          "glucose": {
            "value": 95,
            "unit": "mg/dL",
            "reference_range": "70-100",
            "status": "normal"
          }
        },
        "interpretation": "Các chỉ số xét nghiệm trong giới hạn bình thường",
        "status": "completed",
        "lab_technician": "tech_001",
        "created_at": "2024-01-20T10:45:00Z",
        "updated_at": "2024-01-21T16:30:00Z"
      }
    }
  ]
}